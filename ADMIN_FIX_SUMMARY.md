# ููุฎุต ุฅุตูุงุญุงุช ุตูุญุฉ ุงูุฅุฏุงุฑุฉ (Admin Dashboard)

## ุงูุชุงุฑูุฎ: 2025-10-30

## ุงููุดุงูู ุงูุชู ุชู ุญููุง โ

### 1. ุญูุงูุฉ ุตูุญุงุช ุงูุฅุฏุงุฑุฉ ูู ุงููุตูู ุบูุฑ ุงููุตุฑุญ ุจู
**ุงููุดููุฉ:** ูุงูุช ุตูุญุงุช ุงูุฅุฏุงุฑุฉ ูุชุงุญุฉ ููุฌููุน ุจุฏูู ูุญุต ุงูุตูุงุญูุงุช

**ุงูุญู:**
- ุชู ุฅูุดุงุก ูููู `ProtectedRoute` ุฌุฏูุฏ ูู `/src/components/ProtectedRoute.jsx`
- ููุญุต ุงููููู ุตูุงุญูุงุช ุงููุณุชุฎุฏู ูุจู ุงูุณูุงุญ ุจุงููุตูู
- ูุนุฑุถ ุฑุณุงูุฉ ุฎุทุฃ ูุงุถุญุฉ ุจุงูุนุฑุจูุฉ ูููุณุชุฎุฏููู ุบูุฑ ุงููุตุฑุญ ููู
- ููุฌู ุงููุณุชุฎุฏููู ุบูุฑ ุงููุณุฌููู ุชููุงุฆูุงู ูุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู

**ุงููููุงุช ุงููุนุฏูุฉ:**
- โ `src/components/ProtectedRoute.jsx` (ุฌุฏูุฏ)
- โ `src/Routes.jsx`

---

### 2. ุฑุจุท ุตูุญุงุช ุงูุฅุฏุงุฑุฉ ุจูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุญููููุฉ
**ุงููุดููุฉ:** ูุงูุช ุตูุญุงุช ุงูุฅุฏุงุฑุฉ ุชุนุฑุถ ุจูุงูุงุช ููููุฉ (Mock Data)

**ุงูุญู:**

#### ุฃ. ุตูุญุฉ ููุญุฉ ุงูุชุญูู ุงูุฑุฆูุณูุฉ (Admin Dashboard)
- ุชู ุฑุจุท ุงูุตูุญุฉ ุจู `adminService.getDashboardStats()`
- ุนุฑุถ ุงูุจูุงูุงุช ุงูุญููููุฉ:
  - ุนุฏุฏ ุงููุณุชุฎุฏููู ุงูููู
  - ุนุฏุฏ ุงูููุงููุงุช ุงููุนููุฉ
  - ุงูููุงู ุงููุดุทุฉ
  - ุฅุฌูุงูู ุงูุฃุฑุจุงุญ
  - ุทูุจุงุช ุงูุณุญุจ ุงููุนููุฉ
- ุฅุถุงูุฉ ุญุงูุงุช ุงูุชุญููู (Loading State)
- ุฅุถุงูุฉ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ูุน ุฅููุงููุฉ ุฅุนุงุฏุฉ ุงููุญุงููุฉ

**ุงููููุงุช ุงููุนุฏูุฉ:**
- โ `src/pages/admin-dashboard/index.jsx`

#### ุจ. ุตูุญุฉ ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู (Users Management)
- ุชู ุฑุจุท ุงูุตูุญุฉ ุจู `adminService.getUsers()`
- ุฌูุจ ุจูุงูุงุช ุงููุณุชุฎุฏููู ุงูุญููููุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุญุณุงุจ ุงูุฅุญุตุงุฆูุงุช ุชููุงุฆูุงู:
  - ุฅุฌูุงูู ุงููุณุชุฎุฏููู
  - ุงููุณุชุฎุฏููู ุงููุนูููู
  - ุงููุณุชุฎุฏููู ุงููุดุทูู
  - ุงููุณุชุฎุฏููู ุงููุนูููู/ุงููุฑููุถูู

**ุงููููุงุช ุงููุนุฏูุฉ:**
- โ `src/pages/users-management/index.jsx`

---

### 3. ุฅุตูุงุญ ูุธุงุฆู ุงูููุงููุฉ ูุงูุฑูุถ
**ุงููุดููุฉ:** ุฃุฒุฑุงุฑ ุงูููุงููุฉ/ุงูุฑูุถ ูุง ุชุนูู ููุง ุชุญุฏุซ ุงูุจูุงูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

**ุงูุญู:**

#### ุงูููุงููุฉ ุนูู ุงููุณุชุฎุฏููู
- ุฑุจุท ุฒุฑ "Approve" ุจู `adminService.approveUser()`
- ูุชู ุงุณุชุฏุนุงุก stored procedure ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช: `approve_user`
- ุชุญุฏูุซ ุญุงูุฉ ุงููุณุชุฎุฏู ุฅูู "approved"
- ุฅุฑุณุงู ููุงูุฃุฉ ุงูุชุฑุญูุจ ุชููุงุฆูุงู
- ุชุญุฏูุซ ุงููุงุฆูุฉ ุชููุงุฆูุงู ุจุนุฏ ุงูููุงููุฉ

#### ุฑูุถ ุงููุณุชุฎุฏููู
- ุฑุจุท ุฒุฑ "Reject/Suspend" ุจู `adminService.rejectUser()`
- ูุชู ุงุณุชุฏุนุงุก stored procedure ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช: `reject_user`
- ุทูุจ ุณุจุจ ุงูุฑูุถ ูู ุงููุณุคูู (ุงุฎุชูุงุฑู)
- ุชุญุฏูุซ ุญุงูุฉ ุงููุณุชุฎุฏู ุฅูู "rejected"
- ุชุญุฏูุซ ุงููุงุฆูุฉ ุชููุงุฆูุงู ุจุนุฏ ุงูุฑูุถ

#### ุงูุนูููุงุช ุงูุฌูุงุนูุฉ (Bulk Actions)
- ุชู ุฅุถุงูุฉ ุฏุนู ุงูููุงููุฉ/ุงูุฑูุถ ุงูุฌูุงุนู
- ูุนุงูุฌุฉ ูู ูุณุชุฎุฏู ุนูู ุญุฏุฉ
- ุนุฑุถ ูุชุงุฆุฌ ุงูุนูููุฉ (ุนุฏุฏ ุงููุฌุงุญุงุช ูุงููุดู)

**ุงููููุงุช ุงููุนุฏูุฉ:**
- โ `src/pages/users-management/index.jsx`

---

### 4. ุชุญุฏูุซ ุงูุจูุงูุงุช ุชููุงุฆูุงู
**ุงููุดููุฉ:** ุงูุจูุงูุงุช ูุง ุชุชุญุฏุซ ุจุนุฏ ุฅุฌุฑุงุก ุนูููุงุช ุงูููุงููุฉ/ุงูุฑูุถ

**ุงูุญู:**
- ุฅุถุงูุฉ `fetchUsers()` ุจุนุฏ ูู ุนูููุฉ ููุงููุฉ/ุฑูุถ
- ุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช ุชููุงุฆูุงู
- ุนุฑุถ ุฑุณุงุฆู ูุฌุงุญ/ูุดู ูุงุถุญุฉ ุจุงูุนุฑุจูุฉ
- ุฅุถุงูุฉ ุญุงูุฉ ุชุญููู ุฃุซูุงุก ุชูููุฐ ุงูุนูููุงุช

---

## ุงูุจููุฉ ุงูุชูููุฉ ุงููุญุณูุฉ ๐๏ธ

### ุญูุงูุฉ ุงููุณุงุฑุงุช (Route Protection)
```jsx
// ุตูุญุงุช ุงูุฅุฏุงุฑุฉ - ุชุชุทูุจ ุตูุงุญูุงุช admin
<Route path="/admin-dashboard" element={
  <ProtectedRoute requireAdmin={true}>
    <AdminDashboard />
  </ProtectedRoute>
} />

// ุตูุญุงุช ุงููุณุชุฎุฏููู - ุชุชุทูุจ ุชุณุฌูู ุฏุฎูู ููุท
<Route path="/user-dashboard" element={
  <ProtectedRoute>
    <UserDashboard />
  </ProtectedRoute>
} />
```

### ุฌูุจ ุงูุจูุงูุงุช
```javascript
// ูู Admin Dashboard
const result = await adminService.getDashboardStats();

// ูู Users Management
const usersData = await adminService.getUsers();
```

### ุฅุฌุฑุงุกุงุช ุงููุณุชุฎุฏููู
```javascript
// ุงูููุงููุฉ
const result = await adminService.approveUser(userId, adminId);

// ุงูุฑูุถ
const result = await adminService.rejectUser(userId, adminId, reason);
```

---

## ุงูููุฒุงุช ุงูุฅุถุงููุฉ ุงููุถุงูุฉ ๐ฏ

1. **ุฑุณุงุฆู ูุงุถุญุฉ ุจุงูุนุฑุจูุฉ** ูู ุฌููุน ุญุงูุงุช ุงูุฎุทุฃ ูุงููุฌุงุญ
2. **ุญุงูุงุช ุชุญููู** ุฃุซูุงุก ุฌูุจ ุงูุจูุงูุงุช ูุชูููุฐ ุงูุนูููุงุช
3. **ูุนุงูุฌุฉ ุดุงููุฉ ููุฃุฎุทุงุก** ูุน ุฅููุงููุฉ ุฅุนุงุฏุฉ ุงููุญุงููุฉ
4. **ูุงุฌูุฉ ูุณุชุฎุฏู ูุญุณูุฉ** ูุน feedback ููุฑู
5. **ุชุญุฏูุซ ุชููุงุฆู ููุจูุงูุงุช** ุจุนุฏ ูู ุนูููุฉ
6. **ููุน ุงูุนูููุงุช ุงููุชุฒุงููุฉ** ุจุงุณุชุฎุฏุงู `actionLoading` flag

---

## ุงููููุงุช ุงููุนุฏูุฉ ๐

### ูููุงุช ุฌุฏูุฏุฉ:
- `src/components/ProtectedRoute.jsx` - ุญูุงูุฉ ุงููุณุงุฑุงุช

### ูููุงุช ูุญุฏุซุฉ:
- `src/Routes.jsx` - ุฅุถุงูุฉ ุญูุงูุฉ ูููุณุงุฑุงุช
- `src/pages/admin-dashboard/index.jsx` - ุฑุจุท ุจุงูุจูุงูุงุช ุงูุญููููุฉ
- `src/pages/users-management/index.jsx` - ุฑุจุท ุจุงูุจูุงูุงุช ูุฅุตูุงุญ ุงูููุงููุฉ/ุงูุฑูุถ

### ูููุงุช ุงูุฎุฏูุงุช ุงููุณุชุฎุฏูุฉ:
- `src/services/adminService.js` - ูุญุชูู ุนูู ุฌููุน ูุธุงุฆู ุงูุฅุฏุงุฑุฉ
- `src/contexts/AuthContext.jsx` - ูุญุต ุงูุตูุงุญูุงุช

---

## ุงูุชุจุนูุงุช ุงููุทููุจุฉ โ๏ธ

ูุฌุจ ุงูุชุฃูุฏ ูู ูุฌูุฏ stored procedures ุงูุชุงููุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:
- `approve_user(target_user_id, admin_id)` - ูููุงููุฉ ุงููุณุชุฎุฏููู
- `reject_user(target_user_id, admin_id, rejection_reason)` - ูุฑูุถ ุงููุณุชุฎุฏููู
- `increment_user_balance(user_uuid, amount)` - ูุชุญุฏูุซ ุงูุฃุฑุตุฏุฉ

---

## ููููุฉ ุงูุงุณุชุฎุฏุงู ๐

### ูููุณุคูููู (Admins):
1. ุณุฌู ุฏุฎููู ุจุญุณุงุจ ูุณุคูู (role = 'admin' ุฃู 'super_admin')
2. ุณุชุชููู ูู ุงููุตูู ูุตูุญุงุช ุงูุฅุฏุงุฑุฉ:
   - `/admin-dashboard` - ููุญุฉ ุงูุชุญูู ุงูุฑุฆูุณูุฉ
   - `/users-management` - ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู
   - `/proofs-review` - ูุฑุงุฌุนุฉ ุงูุฅุซุจุงุชุงุช
   - `/withdrawals-processing` - ูุนุงูุฌุฉ ุงูุณุญูุจุงุช

### ูู ุตูุญุฉ ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู:
1. ุณุชุธูุฑ ูุงุฆูุฉ ุงููุณุชุฎุฏููู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
2. ููููุงููุฉ ุนูู ูุณุชุฎุฏู: ุงุถุบุท ุฒุฑ "Approve" โ
3. ููุฑูุถ/ุงูุชุนููู: ุงุถุบุท ุฒุฑ "Suspend/Reject" โ
4. ููุนูููุงุช ุงูุฌูุงุนูุฉ: ุญุฏุฏ ุงููุณุชุฎุฏููู ุซู ุงุฎุชุฑ ุงูุฅุฌุฑุงุก ูู ุงููุงุฆูุฉ ุงูุนูููุฉ

---

## ุงูุฃูุงู ๐

- โ ุฌููุน ุตูุญุงุช ุงูุฅุฏุงุฑุฉ ูุญููุฉ ุจู ProtectedRoute
- โ ูุญุต ุตูุงุญูุงุช ุงููุณุชุฎุฏู ุนูู ูุณุชูู ุงูู client
- โ ุงูุชุญูู ูู ุงูุตูุงุญูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช (RPC Functions)
- โ ุชุณุฌูู ุฌููุน ุนูููุงุช ุงูุฅุฏุงุฑุฉ ูู ุฌุฏูู audit_logs
- โ ููุน ุงููุตูู ุบูุฑ ุงููุตุฑุญ ุจู ูุน ุฑุณุงุฆู ูุงุถุญุฉ

---

## ุงูุงุฎุชุจุงุฑ ๐งช

### ูุงุฎุชุจุงุฑ ุงูุฅุตูุงุญุงุช:

1. **ุงุฎุชุจุงุฑ ุงูุญูุงูุฉ:**
   ```
   - ุณุฌู ุฏุฎูู ุจุญุณุงุจ ูุณุชุฎุฏู ุนุงุฏู
   - ุญุงูู ุงููุตูู ูู /admin-dashboard
   - ูุฌุจ ุฃู ุชุธูุฑ ุฑุณุงูุฉ "ุบูุฑ ูุตุฑุญ ุจุงููุตูู"
   ```

2. **ุงุฎุชุจุงุฑ ุงูุจูุงูุงุช:**
   ```
   - ุณุฌู ุฏุฎูู ุจุญุณุงุจ ูุณุคูู
   - ุงูุชุญ /admin-dashboard
   - ุชุญูู ูู ุธููุฑ ุงูุจูุงูุงุช ุงูุญููููุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
   ```

3. **ุงุฎุชุจุงุฑ ุงูููุงููุฉ:**
   ```
   - ุงูุชุญ /users-management
   - ุงุจุญุซ ุนู ูุณุชุฎุฏู ุจุญุงูุฉ "pending"
   - ุงุถุบุท "Approve"
   - ูุฌุจ ุฃู ุชุชุญุฏุซ ุงูุจูุงูุงุช ูุชุธูุฑ ุฑุณุงูุฉ ูุฌุงุญ
   ```

4. **ุงุฎุชุจุงุฑ ุงูุฑูุถ:**
   ```
   - ุงุฎุชุฑ ูุณุชุฎุฏู ูุนูู
   - ุงุถุบุท "Reject/Suspend"
   - ุฃุฏุฎู ุณุจุจ ุงูุฑูุถ
   - ูุฌุจ ุฃู ุชุชุญุฏุซ ุงูุจูุงูุงุช
   ```

---

## ููุงุญุธุงุช ูููุฉ โ๏ธ

1. ุชุฃูุฏ ูู ุฃู ุงููุณุชุฎุฏู ุงููุณุฌู ุฏุฎููู ูุฏูู `role = 'admin'` ุฃู `role = 'super_admin'`
2. ุชุญูู ูู ูุฌูุฏ stored procedures ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
3. ุชุฃูุฏ ูู ุฅุนุฏุงุฏุงุช RLS (Row Level Security) ูู Supabase
4. ุฑุงุฌุน console ููุฃุฎุทุงุก ุฅุฐุง ูู ุชุนูู ุงูููุฒุงุช

---

## ุงูุฎุทูุงุช ุงููุงุฏูุฉ ๐

ูููู ุชุญุณูู ุงููุธุงู ุฃูุซุฑ ุจุฅุถุงูุฉ:
- [ ] ูุธุงู ุฅุดุนุงุฑุงุช ูููุณุชุฎุฏููู ุนูุฏ ุงูููุงููุฉ/ุงูุฑูุถ
- [ ] ุชุตุฏูุฑ ุจูุงูุงุช ุงููุณุชุฎุฏููู ุฅูู CSV/Excel
- [ ] ููุชุฑุฉ ูุชูุฏูุฉ ูุจุญุซ ูู ูุงุฆูุฉ ุงููุณุชุฎุฏููู
- [ ] ุนุฑุถ ุชูุงุตูู ูุดุงุท ุงููุณุชุฎุฏู
- [ ] ุฅุญุตุงุฆูุงุช ูุฑุณูู ุจูุงููุฉ ูุชูุฏูุฉ

---

## ุงูุฏุนู ๐ฌ

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู:
1. ุชุญูู ูู console browser ููุฃุฎุทุงุก
2. ุฑุงุฌุน Supabase logs
3. ุชุฃูุฏ ูู ุฅุนุฏุงุฏุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช
4. ุฑุงุฌุน ููู `adminService.js` ูููุธุงุฆู ุงููุชุงุญุฉ

---

**ุชู ุจุญูุฏ ุงููู ุฅุตูุงุญ ุฌููุน ุงููุดุงูู ุงููุฐููุฑุฉ! โจ**
