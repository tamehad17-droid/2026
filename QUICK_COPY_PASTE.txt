â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“‹ Ù…Ù„Ù Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø³Ø±ÙŠØ¹ - Ø§Ù†Ø³Ø® ÙˆØ§Ù„ØµÙ‚ Ù…Ø¨Ø§Ø´Ø±Ø©
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”— Ø±ÙˆØ§Ø¨Ø· Ù…Ø¨Ø§Ø´Ø±Ø© Ù„Ù„Ø¯Ø®ÙˆÙ„:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. SQL Editor (Ø§Ù„Ø®Ø·ÙˆØ© 1):
https://supabase.com/dashboard/project/jtxmijnxrgcwjvtdlgxy/sql/new

2. Edge Functions (Ø§Ù„Ø®Ø·ÙˆØ© 2):
https://supabase.com/dashboard/project/jtxmijnxrgcwjvtdlgxy/functions

3. Settings - Secrets (Ø§Ù„Ø®Ø·ÙˆØ© 3):
https://supabase.com/dashboard/project/jtxmijnxrgcwjvtdlgxy/settings/functions

4. Resend API Keys:
https://resend.com/api-keys

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ Ø§Ù„Ø®Ø·ÙˆØ© 1: SQL Ù„Ø¥ØµÙ„Ø§Ø­ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ (Ø§Ù†Ø³Ø® Ù‡Ø°Ø§)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

CREATE OR REPLACE FUNCTION public.handle_new_user_with_verification()
RETURNS TRIGGER
SECURITY DEFINER
LANGUAGE plpgsql
AS $$
DECLARE
    referral_code_text TEXT;
BEGIN
    referral_code_text := UPPER(SUBSTRING(NEW.id::TEXT FROM 1 FOR 8));
    
    INSERT INTO public.user_profiles (
        id, email, full_name, role, status, 
        approval_status, email_verified, referral_code, 
        level, welcome_bonus_used
    )
    VALUES (
        NEW.id, NEW.email, 
        COALESCE(NEW.raw_user_meta_data->>'full_name', split_part(NEW.email, '@', 1)),
        COALESCE(NEW.raw_user_meta_data->>'role', 'user')::user_role,
        'pending'::user_status, 'pending', false, 
        referral_code_text, 0, false
    );
    
    RETURN NEW;
END;
$$;

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“§ Ø§Ù„Ø®Ø·ÙˆØ© 2: Ø§Ø³Ù…Ø§Ø¡ Ø§Ù„Ø¯Ø§Ù„Ø§Øª
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Function 1 Name: send-verification-email
Function 2 Name: send-notification-email

Ø§Ù„ÙƒÙˆØ¯ Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ:
- promohive/supabase/functions/send-verification-email/index.ts
- promohive/supabase/functions/send-notification-email/index.ts

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ” Ø§Ù„Ø®Ø·ÙˆØ© 3: Secret Name
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Secret Name: RESEND_API_KEY
Secret Value: [Ø§Ø­ØµÙ„ Ø¹Ù„ÙŠÙ‡ Ù…Ù† https://resend.com/api-keys]

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… ØªÙ…! Ø§Ù„Ø¢Ù† Ø¬Ø±Ø¨ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙÙŠ ØªØ·Ø¨ÙŠÙ‚Ùƒ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
